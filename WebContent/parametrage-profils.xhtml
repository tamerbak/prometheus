<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">


<ui:composition template="#{frontController.masterPage}">
	<ui:define name="contenu">
		<p:growl id="growl" showDetail="true" sticky="true" />
		
		<p:dialog id="dlg2" closable="false" widgetVar="dlg2" modal="false"
			resizable="false" dynamic="false">
			<p:graphicImage value="/images/loading.gif" />
			<p:spacer width="20" height="10" />
			<label style="position: relative; bottom: 10px;">Chargement
				...</label>
		</p:dialog>
		
		<div class="index-center">
			<hgroup id="main-title" class="thin">
			<h1 class="titleH1">Gestion des habilitations</h1>
			</hgroup>
		</div>
		<center>
			<h:panelGrid style="text-align:center" columns="6">
				<h:panelGrid columns="1" style="text-align:center;margin-right:20px">
					<p:commandLink action="protogen-administration">
						<p:graphicImage value="img/adminicon/utilisateur.png" style="height: 70px;" />
					</p:commandLink>
					<p:commandLink style="color: black !important;font-weight:bold" 
						action="protogen-administration" value="Utilisateur" />
				</h:panelGrid>
				<h:panelGrid columns="1" style="text-align:center;margin-right:20px;margin-left:20px">
					<p:commandLink action="parametrage-profils" ajax="false">
						<p:graphicImage value="img/adminicon/roles.png" style="height: 70px;" />
					</p:commandLink>
					<p:commandLink style="color: black !important;font-weight:bold" 
						action="parametrage-profils" value="Habilitations" ajax="false" />
				</h:panelGrid>
				<h:panelGrid columns="1" style="text-align:center;margin-left:20px">
					<p:commandLink action="protogen-events">
						<p:graphicImage value="img/adminicon/evenements.png" style="height: 70px;" />
					</p:commandLink>
					<p:commandLink style="color: black !important;font-weight:bold" 
						action="protogen-events" value="Evénements" />
				</h:panelGrid>
				<h:panelGrid columns="1" style="text-align:center;margin-left:20px">
					<p:commandLink action="protogen-organisation" ajax="false">
						<p:graphicImage value="img/adminicon/organisation.png" style="height: 70px;" />
					</p:commandLink>
					<p:commandLink style="color: black !important;font-weight:bold" 
						action="protogen-organisation" value="Organisation" ajax="false" />
				</h:panelGrid>
				<h:panelGrid columns="1" style="text-align:center;margin-left:20px">
					<p:commandLink action="protogen-manage-dashboard" ajax="false">
						<p:graphicImage value="img/adminicon/dashboar-manager.png" style="height: 70px;" />
					</p:commandLink>
					<p:commandLink style="color: black !important;font-weight:bold" 
						action="protogen-manage-dashboard" value="Tableau de board" ajax="false" />
				</h:panelGrid>
				<h:panelGrid columns="1" style="text-align:center;margin-left:20px">
					
						<p:graphicImage value="assets/img/wiki-article.png" style="height: 70px;cursor:pointer;" onclick="window.open('wiki-ArticleList.xhtml');"/>
					
					<a id="articles_bo_url" style="color: black !important;font-weight:bold"  target="_blank"
						href="wiki-ArticleList.xhtml">Gestion des articles</a>
				</h:panelGrid>
			</h:panelGrid>
		</center>
		<p:menubar style="width:100%">
			<p:menuitem icon="ui-icon-calculator" value="Profils et rôles" action="parametrage-profils" ajax="false" />
			<p:menuitem icon="ui-icon-document" value="Nouveau profil" action="parametrage-new-profil" ajax="false" />
			<p:menuitem icon="ui-icon-document" value="Nouveau Rôle" action="parametrage-new-role" ajax="false" />
			<p:menuitem icon="ui-icon-person" value="Utilisateurs" action="parametrage-utilisateurs" ajax="false" />
			<p:menuitem icon="ui-icon-person" value="Nouvel utilisateur" action="#{administrationControl.toNewUser}" ajax="false" />
		</p:menubar>
		<p:spacer width="20" height="20" />
		<p:dialog header="Supprimmer un profil" id="deleteprofil" widgetVar="deleteprofil" >
			<center>Etes vous sûr de vouloir supprimer ce profil ?</center>
			<f:facet name="footer">
				<p:commandButton icon="ui-icon-trash" value="Supprimer" update="@form" 
					 onstart="PF('dlg2').show();" oncomplete="PF('dlg2').hide();deleteprofil.hide();" actionListener="#{profilControl.doDeleteProfil}" />
				<p:commandButton icon="ui-icon-cancel" value="Annuler" type="button" onclick="deleteprofil.hide();"/>
			</f:facet>
		</p:dialog>
		<p:dataTable id="listProfils" value="#{profilControl.profils}" var="prf" style="width:100%"
			emptyMessage="" styleClass="datatableStyle"  >
			<f:facet name="header">Profils de l'application</f:facet>
			<p:column headerText="Profil" >
				<h:outputText value="#{prf.libelle}" />
			</p:column>
			<p:column headerText="Description" >
				<h:outputText value="#{prf.description}" />
			</p:column>
			<p:column style="width:6%" >
				<p:commandButton icon="ui-icon-pencil" title="Modifier" ajax="false" action="#{profilControl.gotoUpdateProfile}" >
					 <f:param name="PROFIL_UPDATE" value="TRUE" />
					 <f:param name="PROFILID" value="#{prf.id}" />
				</p:commandButton>
			</p:column>
			<p:column style="width:6%" >
				<p:commandButton icon="ui-icon-trash" title="Supprimer" update="@form" 
					 onstart="PF('dlg2').show();" oncomplete="PF('dlg2').hide();deleteprofil.show();" actionListener="#{profilControl.deleteProfil}" >
					 <f:param name="PROFILID" value="#{prf.id}" />
				</p:commandButton>
			</p:column>
		</p:dataTable>
		<p:spacer width="20" heigh="20" />
		<p:dataTable id="lisRoles" value="#{profilControl.allRoles}" var="rl" 
			filteredValue="#{profilControl.filteredRoles}" style="width:100%"
			emptyMessage="" styleClass="datatableStyle" >
			<f:facet name="header">Rôles de l'application : Recherche et consultation</f:facet>
			<p:column headerText="Rôle" filterBy="#{rl.role}" filterMatchMode="contains" >
				<h:outputText value="#{rl.role}" />
			</p:column>
			<p:column headerText="Profil" filterBy="#{rl.profil.libelle}" filterMatchMode="contains" >
				<h:outputText value="#{rl.profil.libelle}" />
			</p:column>
			<p:column headerText="Description" filterBy="#{rl.description}" filterMatchMode="contains" >
				<h:outputText value="#{rl.description}" />
			</p:column>
			<p:column style="width:6%" >
				<p:commandButton icon="ui-icon-pencil" title="Modifier" update="@form" 
					 onstart="PF('dlg2').show();" oncomplete="PF('dlg2').hide();" action="parametrage-new-role" >
					 <f:param name="ROLE_UPDATE" value="TRUE" />
					 <f:param name="ROLEID" value="#{rl.id}" />
				</p:commandButton>
			</p:column>
			<p:column style="width:6%" >
				<p:commandButton icon="ui-icon-trash" title="Supprimer" update="@form" 
					 onstart="PF('dlg2').show();" oncomplete="PF('dlg2').hide();" actionListener="#{profilControl.deleteRole}" >
					 <f:param name="ROLEID" value="#{rl.id}" />
				</p:commandButton>
			</p:column>
		</p:dataTable>
	</ui:define>	
</ui:composition>
</html>